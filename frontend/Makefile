# VARIABLES
DOCKER_COMPOSE = docker-compose
CONTAINER      = front-minerva
EXEC           = docker exec -ti $(CONTAINER)

.DEFAULT_GOAL := deploy

deploy: build
	@echo "ğŸ“¦ Build done"

build: rebuild

deps: npm-install

# ğŸ˜ Composer
npm-install:
	$(EXEC) npm ci

# ğŸ³ Docker Compose
start:
	@echo "ğŸš€ Deploy!!!"
	$(DOCKER_COMPOSE) up -d
stop:
	@echo "ğŸ›‘ Stop container!!!"
	$(DOCKER_COMPOSE) stop
recreate:
	@echo "ğŸ”¥ Recreate container!!!"
	$(DOCKER_COMPOSE) up -d --build --remove-orphans --force-recreate
	make start
	make deps
rebuild:
	@echo "ğŸ”¥ Rebuild container!!!"
	$(DOCKER_COMPOSE) build --pull --force-rm --no-cache
	make start